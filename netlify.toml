[build]
  # Base directory for the build (where package.json is located)
  base = "portfolio-frontend/"
  
  # Directory that contains the deploy-ready HTML files and assets generated by the build
  publish = "portfolio-frontend/build/"
  
  # Use custom build script to handle deprecation warnings and optimize for Netlify
  command = "chmod +x scripts/netlify-build.sh && ./scripts/netlify-build.sh"

[build.environment]
  # Node.js version for build (updated to latest LTS)
  NODE_VERSION = "20"
  # Suppress npm warnings during build
  NPM_FLAGS = "--legacy-peer-deps --loglevel=error --no-audit --no-fund"
  # Optimize build for production
  NODE_ENV = "production"
  # Skip source map generation for faster builds
  GENERATE_SOURCEMAP = "false"
  # Disable CI mode to prevent build failures on warnings
  CI = "false"

# Redirect rules for React Router (SPA)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
